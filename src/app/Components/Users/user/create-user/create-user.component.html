<div class="container-fluid bg-light-opac">
  <div class="row">
    <div class="container my-3 main-container">
      <div class="row align-items-center">
        <div class="col">
          <h2 class="content-color-primary page-title">Create User</h2>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="container mt-4 main-container">
  <div class="card mb-4">
    <div class="card-header border-bottom">
      <h5 class="content-color-primary mb-0">User Information</h5>
    </div>
    <form [formGroup]="userCreationForm" (ngSubmit)="submitUserForm()">
      <div class="card-body">
        <div class="row justify-content-center">
          <div class="col-md-10 ">
            <div class="row ">
              <div class="col-lg-6 col-md-6">
                <div class="form-group ">
                  <label>First Name</label>
                  <input type="text" class="form-control" placeholder="" formControlName="firstName" [ngClass]="{'is-invalid': userCreationForm.get('firstName').errors 
                                      && (userCreationForm.get('firstName').touched|| userCreationFormSubmit)}">
                  <div class="invalid-feedback"
                    *ngIf="(userCreationForm.get('firstName').touched||userCreationFormSubmit) && userCreationForm.get('firstName').hasError('required')">
                    This field is required
                  </div>
                </div>
              </div>
              <div class="col-lg-6 col-md-6">
                <div class="form-group ">
                  <label>Last Name</label>
                  <input type="text" class="form-control" placeholder="" formControlName="lastName" [ngClass]="{'is-invalid': userCreationForm.get('lastName').errors 
                  && (userCreationForm.get('lastName').touched|| userCreationFormSubmit)}">
                  <div class="invalid-feedback"
                    *ngIf="(userCreationForm.get('lastName').touched||userCreationFormSubmit) && userCreationForm.get('lastName').hasError('required')">
                    This field is required
                  </div>
                </div>
              </div>
            </div>
            <div class="row ">
              <div class="col-lg-6 col-md-6">
                <div class="form-group ">
                  <label>Email</label>
                  <input type="email" email="true" class="form-control" formControlName="email" placeholder="" [ngClass]="{'is-invalid': userCreationForm.get('email').errors 
                                    && (userCreationForm.get('email').touched|| userCreationFormSubmit)}">
                  <div class="invalid-feedback"
                    *ngIf="(userCreationForm.get('email').touched||userCreationFormSubmit) && userCreationForm.get('email').hasError('required')">
                    This field is required
                  </div>
                  <div class="invalid-feedback"
                    *ngIf="(userCreationForm.get('email').touched||userCreationFormSubmit) && userCreationForm.get('email').hasError('email')">
                    Email is not valid
                  </div>
                </div>
              </div>
              <div class="col-lg-6 col-md-6">
                <div class="form-group ">
                  <label>Cell No</label>
                  <input type="tel" class="form-control" placeholder="" formControlName="cellNo" [ngClass]="{'is-invalid': userCreationForm.get('cellNo').errors 
                  && (userCreationForm.get('cellNo').touched|| userCreationFormSubmit)}">
                  <div class="invalid-feedback"
                    *ngIf="(userCreationForm.get('cellNo').touched||userCreationFormSubmit) && userCreationForm.get('cellNo').hasError('required')">
                    This field is required
                  </div>
                </div>
              </div>
            </div>
            <div class="row ">
              <div class="col-lg-6 col-md-6">
                <div class="form-group ">
                  <label>Home PhoneNo</label>
                  <input type="email" class="form-control" placeholder=""  formControlName="homePhoneNo">
                </div>
              </div>
              <div class="col-lg-6 col-md-6">
                <div class="form-group ">
                  <label>Work PhoneNo</label>
                  <input type="tel" class="form-control" placeholder=""  formControlName="workPhoneNo">
                </div>
              </div>
            </div>

            <div class="row ">
              <div class="col-lg-6 col-md-6">
                <div class="form-group ">
                  <label>Fax No</label>
                  <input type="email" class="form-control" placeholder="" formControlName="faxNo">
                </div>
              </div>
            </div>
            <div class="row ">
              <div class="col-lg-6 col-md-6">
                <div class="form-group">
                  <label>User Type</label>
                  <select2 [data]="userTypes" [cssImport]="true" [value]="userCreationForm.get('userTypeID').value" [ngClass]="{'is-invalid': userCreationForm.get('userTypeID').errors 
                  && (userCreationForm.get('userTypeID').touched||userCreationFormSubmit)}" width="100%" (valueChanged)="setOptionType($event,'userTypeID')">
                  </select2>
                  <div class="invalid-feedback"
                    *ngIf="(userCreationForm.get('userTypeID').touched||userCreationFormSubmit) && userCreationForm.get('userTypeID').hasError('required')">
                    This field is required
                  </div>
                </div>
              </div>
              <div class="col-lg-6 col-md-6">
                <label>Is Individual Permission</label>
                <div class="row">
                  <div class="col-sm-2">
                    <div class="custom-control custom-radio">
                      <input type="radio" class="custom-control-input" name="isIndividualPermission" value="true" id="yes" (change)="isIndividualPermission($event)">
                      <label class="custom-control-label" for="yes"> <span class="">Yes </span></label>
                    </div>
                  </div>
                  <div class="col-sm-2">
                    <div class="custom-control custom-radio">
                      <input type="radio" class="custom-control-input" name="isIndividualPermission" value="false" id="no" (change)="isIndividualPermission($event)">
                      <label class="custom-control-label" for="no"> <span class="">No </span></label>
                    </div>
                  </div>
                </div>
                <div class="text-danger"
                  *ngIf="(userCreationFormSubmit) && userCreationForm.get('isIndividualPermission').hasError('required')">
                  This field is required
                </div>
              </div>
            </div>

            <div class="row border-top border-bottom">
              <div class="col-lg-6 col-md-6" *ngIf="userCreationForm.get('isIndividualPermission').value===false">
                <div class="form-group ">
                  <label>User Role</label>
                  <select2 [data]="userRoles" [cssImport]="true" [value]="userCreationForm.get('roleID').value" [ngClass]="{'is-invalid': userCreationForm.get('roleID').errors 
                  && (userCreationForm.get('roleID').touched||userCreationFormSubmit)}" width="100%" (valueChanged)="setOptionType($event,'roleID')">
                  </select2>
                  <div class="invalid-feedback"
                    *ngIf="(userCreationForm.get('roleID').touched||userCreationFormSubmit) && userCreationForm.get('roleID').hasError('required')">
                    This field is required
                  </div>
                </div>
              </div>
              <div class="col-lg-12 col-md-12" *ngIf="userCreationForm.get('isIndividualPermission').value===true">
                <div *ngIf="userMenus.length>0">
                  <h5>Permissions</h5>
                  <div class="row">
                    <div class="col-lg-6 col-md-6" *ngFor="let item of userMenus">
                      <ul class="list-group list-group-flush">
                        <li class="list-group-item">
                          <div class="form-group">
                            <div class="custom-control custom-checkbox">
                              <input type="checkbox" class="custom-control-input" id="menu{{item.id}}"
                                (click)="showSubmenu(item.id)">
                              <label class="custom-control-label" for="menu{{item.id}}"><b>{{item.menuName}}</b></label>
                            </div>
                          </div>
                          <ul class="list-group list-group-flush ml-3" *ngIf="item.showSubMenu">
                            <li class="list-group-item" *ngFor="let i of item.idoxSubMenuList">
                              <div class="form-group">
                                <div class="custom-control custom-checkbox">
                                  <input type="checkbox" class="custom-control-input" id="subMenu{{i.id}}"
                                    (click)="showSubMenuCrud(item.id,i.id)">
                                  <label class="custom-control-label" for="subMenu{{i.id}}">{{i.subMenuName}}</label>
                                </div>
                              </div>
                              <div class="row" *ngIf="i.showCrud">
                                <div class="col-sm-2">
                                  <div class="form-group">
                                    <div class="custom-control custom-checkbox">
                                      <input type="checkbox" class="custom-control-input" id="subMenuC{{i.id}}" [checked]="true" (change)="addUserRolePerminssions(item.id,i.id,'c',$event)">
                                      <label class="custom-control-label" for="subMenuC{{i.id}}">C</label>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-sm-2">
                                  <div class="form-group">
                                    <div class="custom-control custom-checkbox">
                                      <input type="checkbox" class="custom-control-input" id="subMenuR{{i.id}}" [checked]="true" (change)="addUserRolePerminssions(item.id,i.id,'r',$event)">
                                      <label class="custom-control-label" for="subMenuR{{i.id}}">R</label>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-sm-2">
                                  <div class="form-group">
                                    <div class="custom-control custom-checkbox">
                                      <input type="checkbox" class="custom-control-input" id="subMenuU{{i.id}}" [checked]="true" (change)="addUserRolePerminssions(item.id,i.id,'u',$event)">
                                      <label class="custom-control-label" for="subMenuU{{i.id}}">U</label>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-sm-2">
                                  <div class="form-group">
                                    <div class="custom-control custom-checkbox">
                                      <input type="checkbox" class="custom-control-input" id="subMenuD{{i.id}}" [checked]="true" (change)="addUserRolePerminssions(item.id,i.id,'d',$event)">
                                      <label class="custom-control-label" for="subMenuD{{i.id}}">D</label>
                                    </div>
                                  </div>
                                </div>
                              </div>
        
                            </li>
                          </ul>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="row ">
              <div class="col-lg-4 col-md-4">
                <div class="form-group ">
                  <label>Username</label>
                  <input type="text" class="form-control" formControlName="userName" placeholder="" [ngClass]="{'is-invalid': userCreationForm.get('userName').errors 
                  && (userCreationForm.get('userName').touched|| userCreationFormSubmit)}">
                  <div class="invalid-feedback"
                    *ngIf="(userCreationForm.get('userName').touched||userCreationFormSubmit) && userCreationForm.get('userName').hasError('required')">
                    This field is required
                  </div>
                </div>
              </div>
              <div class="col-lg-4 col-md-4">
                <div class="form-group ">
                  <label>Password</label>
                  <input type="password" class="form-control" formControlName="password" placeholder="" [ngClass]="{'is-invalid': userCreationForm.get('password').errors 
                  && (userCreationForm.get('password').touched|| userCreationFormSubmit)}">
                  <div class="invalid-feedback"
                    *ngIf="(userCreationForm.get('password').touched||userCreationFormSubmit) && userCreationForm.get('password').hasError('required')">
                    This field is required
                  </div>
                </div>
              </div>
              <div class="col-lg-4 col-md-4">
                <div class="form-group ">
                  <label>Confirm Password</label>
                  <input type="password" class="form-control" formControlName="confirmPassword" placeholder="" [ngClass]="{'is-invalid': userCreationForm.get('confirmPassword').errors 
                  && (userCreationForm.get('confirmPassword').touched && userCreationForm.hasError('mismatch') || userCreationFormSubmit)}">
                  <div class="invalid-feedback"
                    *ngIf="(userCreationForm.get('confirmPassword').touched||userCreationFormSubmit) && userCreationForm.get('confirmPassword').hasError('required')">
                    This field is required
                  </div>
                  <div class="text-danger" *ngIf="userCreationForm.hasError('mismatch') && userCreationForm.get('confirmPassword').touched">Password must match</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="card-footer text-center">
        <button type="submit" class="btn btn-success">Submit</button>
      </div>
    </form>

  </div>
</div>